================================================================================
                    EXPLICATIONS DES FICHIERS app.py ET data_loader.py
================================================================================

Ce document explique le fonctionnement des deux fichiers principaux de votre 
Portfolio Assistant IA.

================================================================================
1. DATA_LOADER.PY - Le chargeur de donn√©es
================================================================================

OBJECTIF:
Ce script charge les fichiers Markdown du portfolio et les indexe dans 
Upstash Vector (une base de donn√©es vectorielle).

FONCTIONNEMENT D√âTAILL√â:

üì¶ IMPORTS:
- os, Path: Pour manipuler les fichiers
- dotenv: Pour charger les variables d'environnement
- upstash_vector: Pour communiquer avec la base de donn√©es vectorielle
- re: Pour utiliser les expressions r√©guli√®res

üîß FONCTION chunk_markdown(content: str):
Cette fonction divise le contenu Markdown en morceaux intelligents.

  √âtapes:
  1. Utilise une expression r√©guli√®re pour diviser le contenu par sections
     (lignes commen√ßant par ##)
  2. Parcourt les sections appari√©es (titre + contenu)
  3. Combine chaque titre avec son contenu
  4. Filtre les chunks trop courts (moins de 10 caract√®res)
  5. Retourne une liste de chunks

  Exemple:
  Input:  "## Section 1\nContenu 1\n## Section 2\nContenu 2"
  Output: ["## Section 1\nContenu 1", "## Section 2\nContenu 2"]

‚öôÔ∏è PROCESSUS D'INDEXATION:

1. INITIALISATION:
   - Cr√©e une connexion √† Upstash Vector avec les credentials du .env

2. LECTURE DES FICHIERS:
   - Parcourt tous les fichiers .md du dossier "data"
   - Pour chaque fichier trouv√© (Competences.md, Experiences.md, etc.)

3. CHUNKING:
   - Divise le contenu en chunks coh√©rents avec la fonction chunk_markdown()

4. CR√âATION DES VECTEURS:
   - Cr√©e des objets Vector avec:
     * id: identifiant unique (exemple: "Experiences-0")
     * data: le contenu texte du chunk
     * metadata: dictionnaire avec "source" (nom du fichier)

5. UPLOAD PAR BATCH:
   - Envoie les vecteurs par lots de 100 (optimisation)
   - Cela √©vite de surcharger l'API

6. CONFIRMATION:
   - Affiche le nombre total de chunks index√©s

R√âSULTAT FINAL:
Tous les contenus Markdown sont maintenant disponibles dans une base vectorielle
o√π on peut faire des recherches s√©mantiques (par sens, pas par simple texte).

================================================================================
2. APP.PY - L'interface Streamlit
================================================================================

OBJECTIF:
Cr√©e une interface web interactive o√π les utilisateurs peuvent poser des 
questions sur le portfolio. L'IA utilise la base vectorielle pour r√©pondre.

FONCTIONNEMENT D√âTAILL√â:

üì¶ IMPORTS:
- streamlit: Framework pour cr√©er l'interface web
- os, dotenv: Pour g√©rer l'environnement
- upstash_vector: Pour interroger la base vectorielle
- agents: Module personnalis√© pour cr√©er l'agent IA

‚öôÔ∏è CONFIGURATION DE LA PAGE:
st.set_page_config():
  - Titre: "Portfolio IA"
  - Ic√¥ne: üë§
  - Layout: "wide" (utilise toute la largeur)

üîê V√âRIFICATIONS DE CONFIGURATION:
1. V√©rifie que OPENAI_API_KEY est pr√©sente (sinon affiche erreur et stop)
2. V√©rifie que UPSTASH_VECTOR_REST_URL est pr√©sente (sinon affiche erreur et stop)

Ces variables doivent √™tre dans le fichier .env

üîó CONNEXION √Ä UPSTASH:
Cr√©e un Index (connexion) avec:
  - url: Adresse API Upstash
  - token: Jeton d'authentification

üîç FONCTION @function_tool search_portfolio(query, top_k=5):
C'est une "tool" que l'IA peut utiliser pour chercher dans le portfolio.

  Param√®tres:
  - query: La question ou terme √† chercher
  - top_k: Nombre maximum de r√©sultats (5 par d√©faut)

  Processus:
  1. Envoie la requ√™te √† Upstash Vector
  2. R√©cup√®re les top_k r√©sultats les plus pertinents
  3. Pour chaque r√©sultat, extrait:
     * source: Le fichier d'origine (Experiences, Competences, etc.)
     * data: Le contenu du chunk
  4. Formate les r√©sultats lisiblement
  5. Retourne une cha√Æne de caract√®res avec tous les r√©sultats
  6. En cas d'erreur, retourne un message d'erreur

  Exemple de r√©sultat:
  "[1] Experiences:
   ## D√©veloppeur Python 2023-2024
   ...
   
   [2] Competences:
   ## Python, JavaScript, SQL
   ..."

ü§ñ CR√âATION DE L'AGENT IA:
Cr√©e un agent avec:
  - name: "portfolio-agent"
  - instructions: Instructions syst√®me en fran√ßais
  - model: "gpt-4.1-nano" (mod√®le GPT-4 nano)
  - model_settings: Temp√©rature = 0.7 (√©quilibre cr√©ativit√©/coh√©rence)
  - tools: [search_portfolio] (l'IA peut utiliser cette fonction)

L'agent va automatiquement:
  - Comprendre la question de l'utilisateur
  - Appeler search_portfolio si n√©cessaire
  - R√©pondre en fran√ßais avec les informations trouv√©es

üí¨ GESTION DE LA CONVERSATION:

st.session_state.messages:
  - Stocke l'historique de la conversation
  - Persiste pendant la session utilisateur
  - Format: Liste de dictionnaires {"role": "user"/"assistant", "content": "..."}

Affichage:
  - Boucle through les messages existants
  - Affiche chaque message avec st.chat_message()

üéØ FLUX D'UNE QUESTION:

1. L'utilisateur tape une question dans le chat_input
2. La question est ajout√©e √† st.session_state.messages
3. La question s'affiche dans le chat
4. Un spinner "Recherche en cours..." s'affiche
5. L'agent traite la question:
   - Analyse le texte
   - Appelle search_portfolio
   - G√©n√®re une r√©ponse
6. La r√©ponse s'affiche dans le chat
7. La r√©ponse est sauvegard√©e dans l'historique

Gestion d'erreurs:
  - Si erreur pendant le traitement ‚Üí Affiche un message d'erreur

üìã SIDEBAR (Barre lat√©rale):
- Affiche une section "Aide" avec des exemples de questions
- Bouton "Effacer l'historique" qui:
  * Vide st.session_state.messages
  * R√©ex√©cute la page (st.rerun())

================================================================================
3. FLUX COMPLET DU SYST√àME
================================================================================

INITIALISATION (Une seule fois):
  data_loader.py s'ex√©cute manuellement:
    Markdown files (data/*.md)
           ‚Üì
    Chunk√©es en sections coh√©rentes
           ‚Üì
    Converties en vecteurs
           ‚Üì
    Upload√©es dans Upstash Vector

UTILISATION EN DIRECT:
  Utilisateur pose une question
           ‚Üì
  app.py lance l'agent
           ‚Üì
  L'agent utilise search_portfolio
           ‚Üì
  Upstash Vector retourne les chunks pertinents
           ‚Üì
  GPT-4 g√©n√®re une r√©ponse pertinente en fran√ßais
           ‚Üì
  R√©ponse affich√©e √† l'utilisateur

================================================================================
4. TECHNOLOGIES UTILIS√âES
================================================================================

- Streamlit: Interface web interactive
- OpenAI GPT-4: Mod√®le de langue pour les r√©ponses
- Upstash Vector: Base de donn√©es vectorielle pour recherche s√©mantique
- Python: Langage de programmation

AVANTAGES DE CETTE ARCHITECTURE:

‚úÖ Recherche s√©mantique: Trouve des r√©ponses m√™me avec des questions reformul√©es
‚úÖ Interface intuitive: Chat simple et √©l√©gant
‚úÖ Scalabilit√©: Upstash g√®re la base de donn√©es
‚úÖ Pas de donn√©es sensibles: Les embeddings sont stock√©s dans le cloud s√©curis√©
‚úÖ Agent autonome: L'IA d√©cide quand utiliser la recherche

================================================================================
FIN DU DOCUMENT
================================================================================
